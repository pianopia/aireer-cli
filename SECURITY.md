# セキュリティガイドライン

## 🔐 機密情報の管理

aireer-cliでは以下の機密情報を適切に管理してください：

### ローカル設定ファイル

以下のファイルには機密情報が含まれるため、Gitで追跡されません：

- `.aireer-config.json` - ユーザー認証情報とAPIキー
- `.aireer-execution-history.json` - 実行履歴の詳細
- `.aireer-priorities.json` - ルーチンの優先度設定
- `.aireer-logs/` - ログファイル

### APIキーの安全な管理

#### Gemini APIキー
```bash
# ✅ 正しい設定方法
aireer config --gemini-key YOUR_GEMINI_API_KEY

# ❌ 避けるべき: 環境変数での永続化
export GEMINI_API_KEY=your-key-here
```

#### 認証トークン
- ログイン時に自動でローカル設定ファイルに保存されます
- 手動でトークンを編集しないでください
- `aireer logout` で安全に削除できます

## 🚨 セキュリティリスク

### 避けるべき行為

1. **設定ファイルの共有**
   - `.aireer-config.json` をGitにコミットしない
   - 他の開発者と設定ファイルを直接共有しない

2. **APIキーのハードコーディング**
   - ソースコードにAPIキーを埋め込まない
   - 設定ファイルやCLIコマンドで管理する

3. **ログファイルの公開**
   - ログファイルにAPIレスポンスが含まれる場合があります
   - 公開リポジトリにログファイルをコミットしない

## 🛡️ セキュリティ対策

### 1. ファイアウォール設定
- ローカル開発時のポート3000は外部からアクセスできないよう設定

### 2. ネットワークセキュリティ
- HTTPS通信のみを使用（本番API: `https://api.aireer.work`）
- TLS証明書の有効性を確認

### 3. 権限管理
- 最小権限の原則に従ってAPIキーの権限を設定
- 不要になったAPIキーは速やかに無効化

## 🔒 実行時セキュリティ制約

### ファイル操作の制限
- すべてのファイル操作は指定されたワーキングディレクトリ内に制限されます
- ディレクトリトラバーサル攻撃（../など）は自動的にブロックされます
- システム重要ファイルへのアクセスは禁止されます

### コマンド実行の制限
以下のコマンドは自動的にブロックされます：
- システム管理コマンド（shutdown, reboot, halt等）
- 危険なファイル操作（rm -rf /, format等）
- システム重要ディレクトリへの操作（/etc/, /usr/, /bin/等）
- 不必要なsudo権限の使用

### 実行制限
- コマンド実行は30秒でタイムアウトします
- 異常な動作を検知した場合は自動停止します
- Ctrl+Cによる緊急停止は常に可能です

## 🔍 脆弱性報告

セキュリティの脆弱性を発見した場合は、以下にご報告ください：

- **GitHub Issues**: [セキュリティラベル付きで報告](https://github.com/pianopia/aireer-cli/issues)
- **対応時間**: 通常24-48時間以内に初回応答

## 📋 セキュリティチェックリスト

デプロイ前のチェック項目：

- [ ] `.gitignore` に機密ファイルが含まれている
- [ ] ソースコードにAPIキーが含まれていない
- [ ] 環境変数に機密情報が含まれていない
- [ ] テストデータに実際の個人情報が含まれていない
- [ ] ログファイルが適切に除外されている
- [ ] ワーキングディレクトリの制限が有効になっている
- [ ] 危険なコマンドのブロック機能が動作している

## 🔄 セキュリティアップデート

- 定期的に依存関係を更新してください
- セキュリティアップデートは優先的に適用してください
- `npm audit` で脆弱性を定期チェックしてください

```bash
# セキュリティチェック
npm audit

# 自動修正
npm audit fix
``` 